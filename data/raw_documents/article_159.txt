The reaction mechanism for the Johnson – Corey – Chaykovsky reaction consists of nucleophilic addition of the ylide to the carbonyl or imine group . A negative charge is transferred to the heteroatom and because the sulfonium cation is a good leaving group it gets expelled forming the ring . In the related Wittig reaction , the formation of the much stronger phosphorus @-@ oxygen double bond prevents <unk> formation and instead , <unk> takes place through a 4 @-@ membered cyclic intermediate . The trans diastereoselectivity observed results from the reversibility of the initial addition , allowing equilibration to the favored anti betaine over the syn betaine . Initial addition of the ylide results in a betaine with adjacent charges ; density functional theory calculations have shown that the rate @-@ limiting step is rotation of the central bond into the conformer necessary for backside attack on the sulfonium . The degree of reversibility in the initial step ( and therefore the diastereoselectivity ) depends on four factors , with greater reversibility corresponding to higher selectivity : Stability of the substrate with higher stability leading to greater reversibility by favoring the starting material over the betaine . Stability of the ylide with higher stability similarly leading to greater reversibility . <unk> hindrance in the betaine with greater hindrance leading to greater reversibility by <unk> formation of the intermediate and slowing the rate @-@ limiting rotation of the central bond . <unk> of charges in the betaine by <unk> such as lithium with greater solvation allowing more facile rotation in the betaine intermediate , lowering the amount of reversibility .